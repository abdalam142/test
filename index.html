<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ูุธุงู ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช</title>

  <!-- ููุชุจุงุช ุฎุงุฑุฌูุฉ (ูุญูููุฉ ูุจู script.js) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
  <script src="https://unpkg.com/html5-qrcode"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>

  <!-- ุฑุงุจุท ููู ุงูุชูุณูู (ุงุญุชูุธูุง ุจุงูุชุตููู ููุง ูู) -->
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- ุดุฑูุท ุงูุญุงูุฉ (ุฏุจู-ูููู ูุฑูุน ููู ุฅูุณู ูุญูู โ ุงูุณูุฑุจุช ูุฑุชุจุท ุจูุฐุง ุงูุนูุตุฑ) -->
  <div id="status" title="ุฏุจู ูููู ูุฑูุน ููู ุงูุฅูุณู ูุญูู">ุฌุงุฑู ูุญุงููุฉ ุชุญููู ููู ุงูุฅูุณู...</div>

  <!-- ููุทูุฉ ุฅุดุนุงุฑุงุช/toasts -->
  <div id="messagesPanel" aria-live="polite"></div>

  <!-- ุฅุดุนุงุฑ ุฏุงุฆู ุฅุฐุง ููู ููุชุฌุงุช ูุญููุธุฉ -->
  <div id="persistentNotice" style="display:none;">
    <div class="notice">
      <div id="persistentText">ูุฏูู ููุชุฌุงุช ูุญููุธุฉ ูุญูููุง โ ุณุชุธู ูุญููุธุฉ ุญุชู ุชุญุฐููุง.</div>
      <div><button id="dismissPersistent" type="button" class="btn ghost">ุฅุฎูุงุก</button></div>
    </div>
  </div>

  <!-- ุงูุชุทุจูู -->
  <div id="app">
    <h2>ูุธุงู ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช</h2>

    <!-- ุดุฑูุท ุงูุฃุฏูุงุช / ุงูุจุญุซ -->
    <div class="searchRow" role="region" aria-label="ุดุฑูุท ุงูุจุญุซ">
      <input id="searchBar" type="text" placeholder="ุงูุชุจ ุงูุงุณู ุฃู ุงูุจุงุฑููุฏ ุฃู ูุตู ุงูููุชุฌ" aria-label="ุจุญุซ" />
      <button id="searchBtn" type="button" class="btn primary">ุจุญุซ</button>
      <button id="clearBtn" type="button" class="btn ghost">ุญุฐู</button>

      <!-- ุฒุฑ ุชุดุบูู ุงููุงุณุญ (ุณูุจุฏูู ุจูู ุงูุชุดุบูู ูุงูุฅููุงู ุจูุงุณุทุฉ ุงูุณูุฑุจุช) -->
      <button id="cameraBtn" type="button" class="btn camera">๐ท QR</button>

      <!-- ููุฏ ุงูููุฒุงู -->
      <button id="scaleBtn" type="button" class="btn ghost">๐ถ ููุฏ ุงูููุฒุงู</button>

      <!-- ูุถุน ุงูุฃุฏูู -->
      <button id="adminBtn" type="button" class="btn ghost" style="margin-left:8px;">ูุถุน ุงูุฃุฏูู</button>
    </div>

    <!-- ุชุญุฐูุฑ ุงูุชูุฑุงุฑ -->
    <div class="dup-warning" id="dupWarning" role="alert" style="display:none;"></div>

    <!-- ูุงุฑุฆ ุงููุงููุฑุง (html5-qrcode) -->
    <div id="reader" aria-hidden="true" style="display:none;"></div>

    <!-- ุงูุฌุฏุงูู: ูุชุงุฆุฌ ุงูุจุญุซ + ุงูููุชุฌุงุช ุงููุฎุชุงุฑุฉ -->
    <div class="tables">
      <!-- ูุชุงุฆุฌ ุงูุจุญุซ -->
      <div class="col" aria-label="ูุชุงุฆุฌ ุงูุจุญุซ">
        <h3>ูุชุงุฆุฌ ุงูุจุญุซ</h3>
        <div style="text-align:left; margin-bottom:6px;">
          <button id="clearResultsBtn" type="button" style="display:none;" class="btn ghost">ุญุฐู ุงููู</button>
        </div>
        <table id="results" aria-live="polite">
          <thead>
            <tr>
              <th>ุงุณู ุงูููุชุฌ</th>
              <th>ุณุนุฑ</th>
              <th>ููุฏ ุงูููุฒุงู</th>
              <th>QR</th>
              <th>ุฅุฌุฑุงุก</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <!-- ุงูููุชุฌุงุช ุงููุฎุชุงุฑุฉ -->
      <div class="col" aria-label="ุงูููุชุฌุงุช ุงููุฎุชุงุฑุฉ">
        <h3>ุงูููุชุฌุงุช ุงููุฎุชุงุฑุฉ (<span id="selectedCount">0</span>)</h3>
        <div style="text-align:left; margin-bottom:6px;">
          <button id="clearAllBtn" type="button" class="btn ghost" style="display:none">ุญุฐู ุงููู (ุฃุฏูู)</button>
          <button id="showCancelledBtn" type="button" class="btn ghost" style="margin-left:8px;">ุฅุธูุงุฑ ุงูููุบู</button>
        </div>

        <table id="finalResults" aria-live="polite">
          <thead>
            <tr>
              <th>ุงุณู ุงูููุชุฌ</th>
              <th>ุงูุนุฏุฏ</th>
              <th>ููุฏ ุงูููุฒุงู</th>
              <th>Barcode</th>
              <th>ุงูุชุงุฑูุฎ</th>
              <th>ุงูุญุงูุฉ</th>
              <th>ุฅุฌุฑุงุก</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>

        <div style="margin-top:8px; text-align:left;">
          <button id="exportBtn" type="button" class="btn primary">ุชุตุฏูุฑ ุฅูุณู</button>
          <button id="exportPdfBtn" type="button" class="btn primary" style="margin-left:8px;">ุชุตุฏูุฑ PDF</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ููุฏุงู/ุญูุงุฑ ุนุงู (ุจุฏูู alert/prompt) -->
  <div class="dialog-overlay" id="dialogModal" style="display:none;">
    <div class="dialog" role="dialog" aria-modal="true" aria-labelledby="dialogTitle">
      <h4 id="dialogTitle">ุนููุงู</h4>
      <div class="dialog-msg" id="dialogMsg"></div>
      <input id="dialogInput" class="dialog-input" style="display:none;" />
      <div class="dialog-actions" id="dialogActions">
        <button id="dialogCancel" type="button" class="btn ghost">ุฅูุบุงุก</button>
        <button id="dialogOk" type="button" class="btn primary">ููุงูู</button>
      </div>
    </div>
  </div>

  <!-- ููุฏุงู ุงูุงุณุชูุงู (ูุฌุจ ุฃู ูุชุทุงุจู ูุฐุง ุงููููู ูุน ูุง ูุชููุนู script.js) -->
  <div class="modal-overlay" id="receiveModal" style="display:none;">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <h4 id="modalTitle">ุงุณุชูุงู ุงูููุชุฌ</h4>
      <div id="modalName" style="text-align:center; font-weight:700; margin-bottom:8px;"></div>
      <input id="modalInput" class="modal-input" inputmode="decimal" placeholder="ุงูุนุฏุฏ ุฃู ุงููุฒู (ูุซุงู: 2 ุฃู 0.5)" autocomplete="off" />
      <div class="numpad" aria-hidden="false">
        <button type="button" data-key="7">7</button>
        <button type="button" data-key="8">8</button>
        <button type="button" data-key="9">9</button>
        <button type="button" data-key="4">4</button>
        <button type="button" data-key="5">5</button>
        <button type="button" data-key="6">6</button>
        <button type="button" data-key="1">1</button>
        <button type="button" data-key="2">2</button>
        <button type="button" data-key="3">3</button>
        <button type="button" id="modalBack">โซ</button>
        <button type="button" data-key="0">0</button>
        <button type="button" data-key=".">.</button>
      </div>
      <div class="actions" style="display:flex; gap:8px; justify-content:center; margin-top:12px">
        <button id="modalCancel" type="button" class="btn ghost">ุฅูุบุงุก</button>
        <button id="modalConfirm" type="button" class="btn primary">ุชู</button>
      </div>
    </div>
  </div>

  <!-- ููู ุฑูุน ูุฎูู: ุงูุณูุฑุจุช ููุนููู ุนูุฏ ุฏุจู-ูููู ุนูู #status -->
  <input id="fileInput" type="file" accept=".xlsx,.xls" style="display:none" />

  <!-- ุณูุฑุจุช ุงููุดุฑูุน -->
  <script src="script.js"></script>
</body>
</html>
